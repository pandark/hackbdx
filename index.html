<!doctype html>
<html>
    <header>
        <meta charset="utf-8">
        <title>Limited funds, unlimited activities!</title>
        <link href="main.css" rel="stylesheet" type="text/css">
    </header>
    <body>
        <p id="step1"><button onclick="geoFindMe()" id="geofindme">Locate me.</button></p>
        <div id="step2">
            <p id="ihavemoney">I have <input type="number" min="0" name="price" id="price" /> &euro;</p>
            <p id="getresults"><button onclick="getResults()">What can I do?</button></p>
        </div>
        <div id="canvas"></di>
        <div id="solution">
            <div id="map"></div>
            <div id="list"></div>
        </div>
        <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearchLite.min.js"></script>
        <script>
var lat;
var lng;
var max_price;
var stepOne = document.getElementById('step1');
var stepTwo = document.getElementById('step2');
var solution = document.getElementById('solution');
stepTwo.style.display = 'none';
solution.style.display = 'none';
function errorCallback(error) {
    console.log('ERROR(' + error.code + '): ' + error.message);
};
function geoFindMe() {
    var geoFindMeButton = document.getElementById('geofindme');

    if (!navigator.geolocation) {
        geoFindMeButton.innerHTML = 'Geolocation is not supported by your browser';
        return;
    }

    function success(position) {
        lat  = position.coords.latitude;
        lng = position.coords.longitude;

        stepOne.style.display = 'none';
        stepTwo.style.display = 'block';
    }

    function error(err) {
        console.log(err);
        geoFindMeButton.innerText = 'Unable to retrieve your location';
        stepOne.style.display = 'block';
        stepTwo.style.display = 'none';
    }

    geoFindMeButton.innerHTML = 'locating&hellip;';

    navigator.geolocation.getCurrentPosition(success, error);
}
function getResults() {
    max_price = parseInt(document.getElementById('price').value, 10);
    if (lat === undefined || lng === undefined || isNaN(max_price) || max_price < 0) { return; }
    //request data(lat, lng, max_price)

    var client = algoliasearch('4X7CFUTU6C', 'eccbc3129b40cc4f17bba23e5d19228b');
    var index = client.initIndex('Hackathon');

    //var results =

    index.search({query: '', numericFilters: ['price.value <= 'Â + max_price * 100], aroundLatLng: '' + lat + ',' + lng}, function(err, content) {
        console.log(err);
        console.log(content.hits);
    });

    //replace #result#list with the data
    solution.style.display = 'block';
}
        </script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    		<script type="text/javascript" src="js/detector.js"></script>
    		<script src="//cdnjs.cloudflare.com/ajax/libs/three.js/r71/three.js"></script>
    		<script src="//rawgit.com/mrdoob/three.js/eee231960882f6f3b6113405f524956145148146/examples/js/controls/OrbitControls.js"></script>
    		<script type="text/javascript" src="./data.js"></script>
    		<script type="text/javascript" src="./new.js"></script>
    </body>
</html>
